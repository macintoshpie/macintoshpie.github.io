image: alpine/edge
oauth: pages.sr.ht/PAGES:RW
packages:
- hut
- go
environment:
  site: macintoshpie.srht.site
  my_domain: www.tedsummer.com
tasks:
- package: |
    cd ${site}
    go run ./cmd/build
    cd ./build
    tar -cvz . > ../../site.tar.gz
- upload: |
    hut pages publish -d ${my_domain} -p HTTPS site.tar.gz
    hut pages publish -d ${my_domain} -p GEMINI site.tar.gz
